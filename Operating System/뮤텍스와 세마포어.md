# 뮤텍스와 세마포어

프로세스 간 메시지를 전송하거나, 공유 메모리를 통해 공유된 자원에 대해 여러 개의 프로세스가 동시에 접근하면 Critical Section (임계구역) 문제가 발생할 수 있다. 이러한 문제를 해결하기 위해 데이터를 한 번에 하나의 프로세스만 접근할 수 있도록 뮤텍스와 세마포어를 사용한다. 뮤텍스와 세마포어는 공유된 자원의 데이터를 여러 스레드/프로세스가 접근하는 것을 막는 역할을 한다.

</br>

</br>

### Mutex (뮤텍스)

뮤텍스는 공유된 자원의 데이터 혹은 임계영역에 하나의 프로세스, 스레드만 접근할 수 있도록 하는 것이다. 한 스레드, 프로세스에 의해 소유될 수 있는 Key를 기반으로 한 상호배제기법이다.

> 임계구역 : 멀티 스레드 시스템에서 스레드가 공통의 변수를 바꾸거나 table을 업데이트하거나 파일에 써서 생기는 코드의 한 부분. 즉 공유 자원에 접근하는 코드의 영역을 말한다. 만약 임계구역에 프로세스가 동시에 접근하면 공통 변수가 동시에 업데이트되거나 잘못된 값이 출력될 수 있다.

- 임계구역을 가진 스레드들의 실행시간이 서로 겹치지 않고, 각각 단독으로 실행되도록 하는 기술
- 한 프로세스에 의해 소유될 수 있는 Key를 기반으로 한 상호배제 기법
  - Key에 해당하는 어떤 객체(Object)가 있으며, 이 객체를 소유한 스레드와 프로세스만이 공유 자원에 접근
  - ex) 한 개의 화장실과 한 개의 키 예시
- 동기화 (Synchronization), 락(Lock)을 사용함으로써 뮤텍스 객체를 두 스레드가 동시에 사용할 수 없음

</br>

</br>

### Semaphore (세마포어)

세마포어는 공유된 자원의 데이터 혹은 임계영역에 하나의 프로세스, 스레드만 접근할 수 있도록 하는 것이다. 현재 공유자원에 접근할 수 있는 스레드, 프로세스의 수를 나타내는 값을 두어 상호배제를 달성하는 기법이다.

- 사용하고 있는 스레드/프로세스의 수를 공통으로 관리하는 하나의 값(카운터)을 이용한 상호 배제 기법
  - ex) 세 개의 화장실과 3을 표시하는 전광판 (카운터)
- 공유 자원에 접근할 수 있는 프로세스의 최대 허용치만큼 동시에 사용자 접근 가능
- 비교적 긴 시간을 확보하는 리소스에 대해 사용
- 자원을 사용하지 않는 상태가 될 때, 대기하던 프로세스가 즉시 자원 사용 가능
- 세마포어를 사용하는 프로세스는 값(카운터)을 확인하고, 자원을 사용하는 동안에는 그 값을 변경함으로써 다른 세마포어 프로세스들이 대기하도록 해야 한다.

</br>

</br>

### 차이점

- 뮤텍스는 동기화 대상이 오직 1개일 때, 사용하고, 세마포어는 동기화 대상이 1개 이상일 때 사용한다.
- 뮤텍스는 자원을 소유할 수 있지만 세마포어는 자원을 소유할 수 없다.
- 뮤텍스는 소유하고 있는 스레드만이 해당 뮤텍스를 해제할 수 있지만 세마포어는 다른 스레드가 세마포어를 해제할 수 있다.